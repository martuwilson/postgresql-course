SELECT
	first_name,
	last_name,
	followers
FROM
	users
WHERE
	"following" >= 4600
	AND followers <= 4700 -- and agrega otra condicion
ORDER BY -- ordenar en base a..
	followers ASC --followes ascendentes

-- BETWEEN
SELECT
	first_name,
	last_name,
	followers
FROM
	users
WHERE
	followers BETWEEN 4600 and 4700 -- lo mismo de arriba pero mas corto porque es en base a la misma columna (followers) pero sin el igual
	ORDER BY
	followers ASC


-- Funciones de agregacion: Agrupaciones MIN,MAX ETC
--cuantos registros tienen la tabla, un conteo:
SELECT
	count(*) AS total_users
FROM
	users;

--cual es el valor minimo de seguidores que tiene ALGUIEN
SELECT
	min(followers) AS min_followers
FROM
	users;

--el maximo:
SELECT
	max(followers) AS max_followers
FROM
	users;

--promedio de followers:
SELECT
	AVG(followers) AS avg_followers
FROM
	users;

-- promedio manual:
SELECT
	sum(followers) / count(*) avg_manual
FROM
	users;

-- redondear
SELECT
	round(AVG(followers)) AS avg_followers
FROM
	users;


--GROUP BY
-- group by
--ej 1: lo muestra juntos pero sin contar ni agrupados
SELECT
	first_name,
	last_name,
	followers
FROM
	users
WHERE followers = 4 or followers = 4999;

--como deberia ser:
SELECT
	count(*),followers
FROM
	users
WHERE
	followers = 4
	OR followers = 4999
GROUP BY followers; --cuenta cuantos tienen 4 y los agrupa y asi mismo con el 4999.

--ej 2:
SELECT
	count(*),
	followers
FROM
	users
WHERE
	followers BETWEEN 4500 and 4700
GROUP BY
	followers
ORDER BY 
followers DESC; -- Cuenta cuántos usuarios hay por cada cantidad exacta de followers, considerando solo los que tienen entre 4500 y 4700 seguidores y los ordena en desc


EXPOSICION: TERMINOLOGIA Y ESTRUCTURAS
dba: data base administrator

DDL: Data definition lenguage -> create, alter, drop, truncate
DML: Data manipulation lenguage--> insert, delete, update
TCL: Transaction control lenguage --> commit, rollback
DQL: Data query lenguage --> Select

Agregate Functions & Filtering:
ademas de los que vimos:
- HAVING: de la mano del group by
- ORDER BY

filtrado de data:
LIKE: filtrado de cierta expresion
IN : DENTRO DE UNA SERIA DE OPCIONES
IS NULL: una cuoluna es nula
IS NOT NULL: viceversa
WHERE
AND : tabla de verdad es TRUE y TRUE
OR: una condicion o la otra
BETWEEN: condiciones entre dos valores

Estructura general del select:

SELECT *,campos,alias,funciones
WHERE condiciones, and, or, in , like
GROUP BY campo agrupador, ALL
HAVING condicion
ORDER BY expresion , ASC , DESC
LIMIT valor, all
OFFSET punto de inicio 




-- having

--saber cuantas personas hay en cada pais
SELECT
	count(*),
	country
FROM
	users
GROUP BY
	country
ORDER BY
	country asc;

-- ahora con having con paises mayores a 6
SELECT
	count(*) AS total,
	country
FROM
	users
GROUP BY
	country
HAVING
	--count(*) > 5
	count(*) BETWEEN 6 and 10
ORDER BY
	count(*) DESC;

-- Distinct
-- Elimina valores duplicados y muestra solo valores únicos de una columna
-- En este caso: obtiene todos los países sin repetir, aunque haya múltiples usuarios del mismo país
-- Si hay 50 usuarios de Argentina, solo muestra "Argentina" una vez
SELECT DISTINCT country from users;

-- group by con otras funciones
-- obtener el dominio del corre electronico y cuantos corres tenemos de ese dominio
SELECT
	count(*),
	SUBSTRING(email, POSITION('@' IN email) + 1) AS domain -- +1 PARA SALTAR UN CARACTER Y EVITAR EL @
FROM
	users
GROUP BY
	DOMAIN
HAVING
	COUNT(*) > 1
ORDER BY
	DOMAIN ASC;


--subqueries

query dentro de otra query

ejemplo:
select * from Tabla A
where (subquery from Tabla B)

